# Rewrites for the whole site. Will split into separate files later.

# Needed so that we can name URL's with the same filename as php files (e.g. /gallery/upload/)
Options -MultiViews

# Rewrites for Sitewide pages
RewriteRule ^login/?$ /login.php
RewriteRule ^logout/?$ /logout.php
RewriteRule ^register/captcha/?$ /user/captcha/captcha.php
RewriteRule ^register/?$ /user/register/register_input.php
RewriteRule ^register/confirm/?$ /user/register/register_confirm.php
RewriteRule ^register/success/?$ /user/register/register_success.php
RewriteRule ^auth/?$ /auth_code.php [QSA]
RewriteRule ^recover/?$ /user/recover/recover_account_input.php
RewriteRule ^recover/confirm/?$ /user/recover/recover_account_confirm.php
RewriteRule ^recover/success/?$ /user/recover/recover_account_success.php

# Rewrites for forums pages
RewriteRule ^forums/thread/(\d+)/?$ /forums/thread/viewthread.php?t=$1
RewriteRule ^forums/thread/(\d+)/(\d+)/?$ /forums/thread/viewthread.php?t=$1&offset=$2
RewriteRule ^forums/board/(\d+)/?$ /forums/viewboard.php?b=$1
RewriteRule ^forums/board/(\d+)/(\d+)/?$ /forums/viewboard.php?b=$1&offset=$2
RewriteRule ^forums/?$ /forums/viewboard.php
RewriteRule ^forums/create/(\d+)/?$ /forums/compose.php?action=create&board=$1
RewriteRule ^forums/reply/(\d+)/?$ /forums/compose.php?action=reply&thread=$1
RewriteRule ^forums/edit/(\d+)/?$ /forums/compose.php?action=edit&post=$1
RewriteRule ^forums/delete/?$ /forums/delete.php
RewriteRule ^forums/markallread/(\d+)/?$ /forums/mark_all_read.php?b=$1

# Rewrites for accounts section
RewriteRule ^user/(\d+)/?$ /user/profile.php?uid=$1
#RewriteRule ^user/(\d+)/forums/?$ /user/profile.php?uid=$1
RewriteRule ^user/(\d+)/gallery/?$ /gallery/user.php?uid=$1
#RewriteRule ^user/(\d+)/fics/?$ /user/profile.php?uid=$1
#RewriteRule ^user/(\d+)/oekaki/?$ /user/profile.php?uid=$1
RewriteRule ^user/(\d+)/preferences/?$ /user/preferences.php?uid=$1
RewriteRule ^user/(\d+)/preferences/bio/save/?$ /user/savebio.php?uid=$1
RewriteRule ^user/(\d+)/mail/?$ /user/mail/mail.php?uid=$1 [QSA]
RewriteRule ^user/(\d+)/mail/unread/?$ /user/mail/mail.php?uid=$1&unread=1 [QSA]
RewriteRule ^user/(\d+)/mail/message/(\d+)/?$ /user/mail/view_message.php?uid=$1&mid=$2
RewriteRule ^user/(\d+)/mail/compose/?$ /user/mail/compose_message.php?uid=$1 [QSA]
RewriteRule ^user/(\d+)/mail/send/?$ /user/mail/mail_action.php?uid=$1&action=send
RewriteRule ^user/auth/change/?$ /user/recover/recover_account_success.php

# Rewrites for gallery pages
RewriteRule ^gallery/post/?$ /gallery/posts/postindex.php [QSA]
RewriteRule ^gallery/post/show/(\d+)/?$ /gallery/posts/viewpost.php?post=$1 [QSA]
RewriteRule ^gallery/upload/?$ /gallery/upload.php
RewriteRule ^gallery/edit/?$ /gallery/posts/editpost.php
RewriteRule ^gallery/pools/?$ /gallery/pools/poolindex.php [QSA]
RewriteRule ^gallery/pools/reorder/(\d+)/?$ /gallery/pools/reorder_pool.php?pid=$1
RewriteRule ^gallery/pools/list/$ /gallery/pools/pool_list.php [QSA]
RewriteRule ^gallery/pools/modify/(\d+)/(\d+)/?$ /gallery/pools/addremove_pool.php?post=$1&pool=$2
RewriteRule ^gallery/pools/create/?$ /gallery/pools/create.php
RewriteRule ^gallery/pools/delete/?$ /gallery/pools/delete.php
RewriteRule ^gallery/post/status/?$ /gallery/posts/changestatus.php
RewriteRule ^gallery/post/show/(\d+)/history/?$ /gallery/posts/tag_history.php?post=$1 [QSA]
RewriteRule ^gallery/tags/?$ /gallery/tags/tags.php [QSA]

#Rewrites for fics pages
RewriteRule ^fics/?$ /fics/index.php
RewriteRule ^fics/browse/?$ /fics/storyindex.php [QSA]
RewriteRule ^fics/story/(\d+)/?$ /fics/story/story.php?sid=$1 [QSA]
RewriteRule ^fics/story/(\d+)/(\d+)/?$ /fics/story/chapter.php?sid=$1&chapter=$2 [QSA]
RewriteRule ^fics/create/?$ /fics/edit_story.php?action=create
RewriteRule ^fics/edit/(\d+)/?$ /fics/edit_story.php?action=edit&sid=$1
RewriteRule ^fics/create/(\d+)/(\d+)/?$ /fics/edit_chapter.php?action=create&sid=$1&chapternum=$2
RewriteRule ^fics/edit/(\d+)/(\d+)/?$ /fics/edit_chapter.php?action=edit&sid=$1&chapternum=$2
RewriteRule ^fics/story/chapter/order/?$ /fics/reorder_chapter.php
RewriteRule ^fics/tags/?$ /fics/tags.php [QSA]
RewriteRule ^fics/search/?$ /fics/storyindex.php [QSA]
RewriteRule ^fics/authors/?$ /fics/authorindex.php [QSA]
RewriteRule ^fics/delete/(\d+)/?$ /fics/delete_story.php?sid=$1&action=delete
RewriteRule ^fics/undelete/(\d+)/?$ /fics/delete_story.php?sid=$1&action=undelete